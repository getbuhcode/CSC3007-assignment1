<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="style.css">
        <title>CSC3007 Assignment 1</title>
    </head>
    <body>
        <table id="table">
            <tr>
                <th>Metric</th>
                <th>National</th>
                <th>Central</th>
                <th>West</th>
                <th>East</th>
                <th>North</th>
                <th>South</th>
            </tr>
        </table>

        <script>
            fetch('https://api.data.gov.sg/v1/environment/psi')
                .then(function (response) {
                    console.log(response);
                    return response.json();
                })
                .then(function (data) {
                    arr = data.items
                    console.log(data.items[0].timestamp);
                    appendData(data);
                })
                .catch(function (err) {
                    console.log(err);
                });
            
            function appendData(data){

                var table = document.getElementById("table");
                var readings = data.items[0].readings;
                
                // loop through the readings' json object
                for(var key in readings){

                    // create new tr and td for each data field
                    var row = document.createElement("tr");
                    var metricCell = document.createElement("td");
                    var nationalCell = document.createElement("td");
                    var centralCell = document.createElement("td");
                    var westCell = document.createElement("td");
                    var eastCell = document.createElement("td");
                    var northCell = document.createElement("td");
                    var SouthCell = document.createElement("td");

                    // assign the data to the corresponding field 
                    metricCell.innerHTML = key;
                    row.append(metricCell);
                    nationalCell.innerHTML = readings[key]["national"]
                    row.append(nationalCell);
                    centralCell.innerHTML = readings[key]["central"]
                    row.append(centralCell);
                    westCell.innerHTML = readings[key]["west"]
                    row.append(westCell);
                    eastCell.innerHTML = readings[key]["east"]
                    row.append(eastCell);
                    northCell.innerHTML = readings[key]["north"]
                    row.append(northCell);
                    SouthCell.innerHTML = readings[key]["south"]
                    row.append(SouthCell);                   

                    // append tr to table
                    table.appendChild(row); 
                }

            }
        </script> 
    </body>
</html>